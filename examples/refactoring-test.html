<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8" />
</head>
<body>
  <div id="stdout"></div>
</body>
<script src="../lib/require.js"></script>
<script>
require.config({
  baseUrl: "../lib",
  paths: {
    "src": "../src"
  }
});

require(["src/file-system"], function(IDBFS) {

var flags = 'FORMAT';
//var flags = undefined;

var fs = new IDBFS.FileSystem('test', flags);
fs.promise.otherwise(
  function(error) {
    console.error(error);
  }
);

function make_tmp_directory() {
  return fs.mkdir('/tmp');
};

function remove_tmp_directory() {
  return fs.rmdir('/tmp');
};

function create_tmp_file() {
  return fs.open('/tmp/1', 'CREATE');
};

fs.promise.then(make_tmp_directory)
          .then(create_tmp_file)
          .then(function() { console.log('done'); })
          .otherwise(function(error) { console.error(error, error.stack); });

});
</script>
</html>
